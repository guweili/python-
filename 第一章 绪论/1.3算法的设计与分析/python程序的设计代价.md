## Python设计的计算代价

### 时间开销：

在考虑python程序的时间开销时，有个问题特别要注意：Python程序中的喝多基本操作不是常量时间的：

1. 基本运算时常量时间操作，逻辑运算是常量时间运算
2. 组合对象的操作有些事常量时间，有些不是，例如：
    1. 复制和切片操作通常需要线性时间与操作对象的长度有关 O(n)
    2. list 和 tuple 的元素访问和元素赋值，是常量时间
    3. dict操作的情况比较复杂
    4. 使用组合对象的程序，需要特别考虑其中的操作的复杂度
    5. 字符串也应该看作组合对象，其许多操作不是常量时间的
    6. 创建对象也需要付出空间和时间，空间和时间代价都与对象大小有关，对于组合对象，这里可能有需要构造的一个个元素，元素有大小问题，整体看还有元素个数问题。通常应该看作线性时间和线性空间操作

3. 在下面有关数据结构和算法的讨论中，将会介绍和分析一些python结构和操作的效率问题，这里首先列举一些具体情况
    1. 构造新的结构，如构造新的list，set等。构造新的空结构（空表，空集合等）是常量时间操作，而构造一个包含n个元素的结构，则至少需要0(n)时间。统计说明，分配长度为n个元素的存储块时间代价是o(n)
    2. 一些list操作的效率：表元素访问和元素修改是常量时间操作，但一般的加入/删除元素操作都是O(n)时间操作
    3. 字典操作的效率：主要操作时加入新的关键码-值对和基于关键码查找关联值。他们的最欢情况复杂度是O(n),但平均负载的是O(1)。这是非常有趣的现象，也就是说，一般而言字典操作的效率很高，但偶尔也会出现效率低的情况
4. 上面复杂度中的n都是有个那结构中的元素个数。程序里经常用到这些操作，他们的效率对程序效率右重大影响。另外，有些操作的效率高，例如在表的最后接入和删除元素效率高，在其他地方加入和删除元素的效率低，应该优先选用前者

### 空间开销：

1. 在程序里使用任何类型的对象，都需要付出空间的代价。建立一个表或者元组，至少要占用元素个数那么多空间。如果一个表的元素个数与问题规模线性相关，建立他的空间付出至少为O(n)（如果元素也是新创建的，还需要考虑元素本身的存储开销）
2. 相对而言，列表和元素是比较简单的数据结构。集合和字典是需要支持的快速查询等操作，其结构更加复杂。包含n个元素的集合或字典，至少需要占用O(n)的存储空间
3. 这里还有两个问题需要特别提出：
    1. python的各种组合数据对象都没有预设的最大元素个数。在实际使用中，这些结构能根据元素的个数的增长自动扩充存储空间。从空间占用的角度看，其实际开下在存续期间可能变大，但通常不会自动缩小（即使后续元素变得很少了）。举个例子，假设程序里建了一个表，而后不断的接入元素导致列表变得很大，而后又不断的删除元素，后来表中的元素变得很少，但占用的存储空间并不减少
    2. 还应该注意python自动存储管理系统的影响。举个例子：如果在程序里建立了一个列表，此后一直将其作为某个全局变量的值，这个对象就会始终存在并占用存储空间。如果将其作为某个函数里局部变量的值，或者虽然作为全局变量的值，但后来通过复制将其抛弃，这个表对象就可以被收回了

总之，在估计python程序的空间开销时，上面这些细节也需要考虑。
python语言提供了很多高级结构，使人很容易通过简短的程序完成很多工作，例如很容易构造出新的列表或元组，这种方便性有时也会带来负面作用。懒散而且不警觉的编程者很容易写出一些貌似正确但实际上完全不能使用的程序，起事件开销太大而且毫无必要，使程序只能处理很小的实例，基本上不能使用；或者空间开销太大，生成大量不必要的数据对象，直至用完了可用内存，导致程序崩溃。构造大量数据对象本身也需要时间，这两个方面的问题往往是纠缠在一起的。


